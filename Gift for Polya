import telebot
from telebot import types

TOKEN = "8567742074:AAHOzCAlNctGOtKFWzOnaOSaQJQ2u-XjJ8s"
bot = telebot.TeleBot(TOKEN)

users = {}

questions = [
    ("ÐšÐ°Ðº Ð²Ð°Ð¼?", [("Ð’Ñ‹ÑÑ‚Ð°Ð²ÐºÐ°", 10), ("ÐšÑ€Ð°ÑÐ½Ð¾Ð´Ð°Ñ€", 20), ("ÐÐ¶Ð¸ÐºÐ¸", 40)]),
    ("ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ Ñ„Ð¸Ð»ÑŒÐ¼?", [("ÐžÐ´Ð¸Ð½ Ð´Ð¾Ð¼Ð°", 10), ("ÐŸÐ¾ÐµÑ…Ð°Ð²ÑˆÐ°Ñ", 20), ("ÐŸÐ¸Ñ€Ð°Ñ‚Ñ‹", 30)]),
    ("ÐŸÐµÑ€Ð²Ñ‹Ð¹ ÐºÐ¾Ð¼Ð¿Ð»Ð¸Ð¼ÐµÐ½Ñ‚:", [("Ð¡Ð¼ÐµÑˆÐ½Ð°Ñ", 10), ("Ð£Ð¼Ð½Ð°Ñ", 20), ("ÐœÐ¸Ð»Ð°Ñ", 30)])
    (" ÐÐ° Ð»Ð¾Ð´Ð¾Ñ‡Ð½Ð¾Ð¹ ÑÑ‚Ð°Ð½Ñ†Ð¸Ð¸ :", [("ÐŸÑ€Ð¾ÑˆÐ»Ð¸ Ð¼Ð¸Ð¼Ð¾", 10), ("ÐÐ°Ñ‡Ð°Ð»Ð¸ Ð²ÑÑ‚Ñ€ÐµÑ‡Ð°Ñ‚ÑŒÑÑ", 20), ("Ð—ÑƒÐ±Ð°Ð¼Ð¸ ÑƒÐ´Ð°Ñ€Ð¸Ð»Ð¸ÑÑŒ", 30)])
("Ð¢Ñ‹ Ñƒ Ð¼ÐµÐ½Ñ:", [("Ð¡Ð¼ÐµÑˆÐ½Ð°Ñ", 10), ("ÐšÑ€Ð°ÑÐ¸Ð²Ð°Ñ", 20), ("Ð¡Ð°Ð¼Ð°Ñ ÐºÑ€Ð°ÑÐ¸Ð²Ð°Ñ, ÑÐ°Ð¼Ð°Ñ ÑƒÐ¼Ð½Ð°Ñ, ÑÐ°Ð¼Ð°Ñ ÑÐ¼ÐµÑˆÐ½Ð°Ñ, ÑÐ°Ð¼Ð°Ñ ÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ð²Ð½Ð°Ñ, ÑÐ°Ð¼Ð° ÑÐ¾Ð»Ð½ÐµÑ‡Ð½Ð°Ñ, ÑÐ°Ð¼Ð°Ñ ÐºÑ€ÐµÐ°Ñ‚Ð¸Ð²Ð½Ð°Ñ, ÑÐ°Ð¼Ð°Ñ ÑÐ°Ð¼Ð°Ñ ÑÐ°Ð¼Ð°Ñ Ð»ÑƒÑ‡ÑˆÐ°Ñ", 50)])
]

@bot.message_handler(commands=["start"])
def start(message):
    users[message.chat.id] = {"step": 0, "score": 0}
    send_question(message.chat.id)

def send_question(chat_id):
    step = users[chat_id]["step"]

    if step >= len(questions):
        finish(chat_id)
        return

    text, answers = questions[step]
    markup = types.InlineKeyboardMarkup()

    for label, score in answers:
        markup.add(types.InlineKeyboardButton(
            text=label,
            callback_data=str(score)
        ))

    bot.send_message(chat_id, text, reply_markup=markup)

@bot.callback_query_handler(func=lambda call: True)
def handle_answer(call):
    chat_id = call.message.chat.id
    score = int(call.data)

    users[chat_id]["score"] += score
    users[chat_id]["step"] += 1

    bot.answer_callback_query(call.id)
    send_question(chat_id)

def finish(chat_id):
    score = users[chat_id]["score"]

    if score <= 80:
        prize = "ðŸŒ· Ð¦Ð²ÐµÑ‚Ñ‹"
    elif score <= 150:
        prize = "ðŸ½ï¸ Ð ÐµÑÑ‚Ð¾Ñ€Ð°Ð½"
    else:
        prize = "ðŸŒ·ðŸ½ï¸ Ð¦Ð²ÐµÑ‚Ñ‹ + Ñ€ÐµÑÑ‚Ð¾Ñ€Ð°Ð½"

    bot.send_message(
        chat_id,
        f"ðŸŽ‰ Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚\n\n"
        f"ÐžÑ‡ÐºÐ¸: {score}\n"
        f"Ð¢Ð²Ð¾Ð¹ Ð¿Ñ€Ð¸Ð·: {prize}\n\n"
        f"Ð¡ Ð´Ð½Ñ‘Ð¼ Ñ€Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ ðŸŽ‚"
    )

bot.polling()
